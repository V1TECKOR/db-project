{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h3 class="fw-bold mb-0">{{ team.name }}</h3>
    <div class="text-white-50">Captain-Bereich</div>
  </div>
  <a class="btn btn-outline-light" href="{{ url_for('teams') }}">← zurück</a>
</div>

<div class="row g-4">
  <div class="col-lg-6">
    <div class="card glass p-4">
      <h5 class="fw-semibold mb-3">Mitglieder</h5>
      {% if members %}
        <ul class="text-white-50 mb-0">
          {% for m in members %}
            <li>{{ m.first_name }} {{ m.last_name }} <span class="text-white-50 small">({{ m.email }})</span></li>
          {% endfor %}
        </ul>
      {% else %}
        <div class="text-white-50">Noch keine Mitglieder.</div>
      {% endif %}
    </div>

    <div class="card glass p-4 mt-4">
      <h5 class="fw-semibold mb-3">Beitrittsanfragen</h5>
      {% if requests %}
        {% for r in requests %}
          <div class="d-flex justify-content-between align-items-center border border-white border-opacity-10 rounded-3 p-2 mb-2">
            <div>
              <div class="fw-semibold">{{ r.first_name }} {{ r.last_name }}</div>
              <div class="text-white-50 small">{{ r.email }}</div>
            </div>
            <form method="post" action="{{ url_for('team_requests') }}" class="d-flex gap-2">
              <input type="hidden" name="team_id" value="{{ team.id }}">
              <input type="hidden" name="user_id" value="{{ r.id }}">
              <button class="btn btn-success btn-sm" name="action" value="approve">Approve</button>
              <button class="btn btn-danger btn-sm" name="action" value="deny">Deny</button>
            </form>
          </div>
        {% endfor %}
      {% else %}
        <div class="text-white-50">Keine offenen Anfragen.</div>
      {% endif %}
    </div>
  </div>

  <div class="col-lg-6">
    <div class="card glass p-4">
      <h5 class="fw-semibold mb-3">Neues Match planen</h5>

      <form method="post" action="{{ url_for('match_create') }}">
        <input type="hidden" name="team_id" value="{{ team.id }}">

        <div class="mb-3">
          <label class="form-label">Gegner</label>
          <input class="form-control" name="opponent" required>
        </div>

        <div class="mb-3">
          <label class="form-label">Ort</label>
          <select class="form-select" name="location">
            <option>Home</option>
            <option>Away</option>
            <option>Other</option>
          </select>
        </div>

        <label class="form-label">Datumsoptionen (min. 1)</label>
        <input class="form-control mb-2" type="datetime-local" name="proposal_dates" required>
        <input class="form-control mb-2" type="datetime-local" name="proposal_dates">
        <input class="form-control mb-3" type="datetime-local" name="proposal_dates">

        <button class="btn btn-primary w-100">Match erstellen</button>
      </form>
    </div>

    <div class="card glass p-4 mt-4">
      <h5 class="fw-semibold mb-2">Matches</h5>
      {% if matches %}
        <div class="table-responsive">
          <table class="table table-sm align-middle mb-0">
            <thead><tr><th>Opponent</th><th>Status</th><th>Final</th><th></th></tr></thead>
            <tbody>
              {% for m in matches %}
                <tr>
                  <td>{{ m.opponent }}</td>
                  <td><span class="badge badge-soft rounded-pill">{{ m.status }}</span></td>
                  <td>{{ m.final_date or '—' }}</td>
                  <td><a class="btn btn-sm btn-outline-light" href="{{ url_for('match_detail', match_id=m.id) }}">Open</a></td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="text-white-50">Noch keine Matches.</div>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}
